/* ⚡ V6.17: Recursive Centering - 遞歸居中校準 */
/* 根據 Rule 1.1: 全量重寫堆疊邏輯，確保金屬邊框視覺上重疊頭像邊緣 */
/* 微調座標：left: 13.5%, top: 48.5% (基於視覺反饋：頭像太左太上方) */

/* ============================================================
   V6.16: HUD Mask - 絕對層級覆蓋，必須在最上層
   使用最高優先級選擇器覆蓋所有衝突規則
   ============================================================ */
#root #layer-master-root #layer-hud-status .hudWrapper .topStatusHud,
#layer-master-root #layer-hud-status .hudWrapper .topStatusHud,
#layer-hud-status .hudWrapper .topStatusHud,
#layer-hud-status .topStatusHud,
.topStatusHud,
[class*='topStatusHud'] {
  /* ⚡ V6.16: 物理層級鎖死 - HUD Mask 必須在 Avatar 之上 */
  z-index: 1000 !important;
}

/* ============================================================
   V6.17: System Text - 同步更新為 top: 48.5%，與 Avatar 保持視覺水平一致
   ============================================================ */
#root #layer-master-root #layer-hud-status .systemReadyText,
#layer-master-root #layer-hud-status .systemReadyText,
#layer-hud-status .systemReadyText,
.systemReadyText,
.topStatusHud .systemReadyText {
  top: 48.5% !important;
}

/* ============================================================
   V6.16: Avatar Container - 物理凹陷效果
   確保頭像在 HUD Mask 之下，實現「坐進駕駛艙」效果
   ============================================================ */
#root #layer-master-root #layer-hud-status .hudWrapper .avatar-section,
#layer-master-root #layer-hud-status .hudWrapper .avatar-section,
#layer-hud-status .hudWrapper .avatar-section,
#layer-hud-status .avatar-section,
.avatar-section {
  position: absolute !important;
  /* ⚡ V6.17: 遞歸居中校準 - 基於視覺反饋微調，向右向下移動 */
  left: 13.5% !important;
  top: 48.5% !important;
  transform: translate(-50%, -50%) !important;
  /* ⚡ V6.16: 物理層級強制壓制 - Avatar 必須在 HUD Mask (z-index: 1000) 之下 */
  z-index: 800 !important;
  width: auto !important;
  height: auto !important;
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  pointer-events: auto !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  overflow: hidden !important;
  /* ⚡ V6.16: 確保不創建新的堆疊上下文 */
  isolation: isolate !important;
}

/* ============================================================
   V6.18: Avatar Image - centerCrop 模式，圖片填滿容器
   使用 object-fit: cover 實現 centerCrop 效果，圖片完全填滿圓形容器
   ============================================================ */
#root #layer-master-root #layer-hud-status .avatar-section .user-avatar,
#layer-master-root #layer-hud-status .avatar-section .user-avatar,
#layer-hud-status .avatar-section .user-avatar,
#layer-hud-status img.user-avatar,
#layer-hud-status .user-avatar,
.avatar-section .user-avatar,
.user-avatar {
  position: relative !important;
  width: 70px !important;
  height: 70px !important;
  /* ⚡ V6.18: centerCrop 模式 - 圖片填滿容器，居中裁剪 */
  object-fit: cover !important;
  object-position: center center !important;
  /* ⚡ V6.18: 移除 scale(0.9)，讓圖片完全填滿容器 */
  transform: none !important;
  /* ⚡ V6.16: 完美圓形裁剪 - 強制執行 */
  clip-path: circle(50%) !important;
  -webkit-clip-path: circle(50%) !important;
  border-radius: 50% !important;
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  /* ⚡ V6.16: 物理層級強制壓制 - 繼承父容器 z-index: 800 */
  z-index: inherit !important;
  margin: 0 !important;
  padding: 0 !important;
  min-width: 70px !important;
  min-height: 70px !important;
  /* ⚡ V6.17: 臨時調試邊框 - 青色十字線用於對齊驗證 */
  border: 1px solid cyan !important;
  /* ⚡ V6.18: 確保背景透明，不顯示白色背景 */
  background-color: transparent !important;
  background: transparent !important;
  background-image: none !important;
  box-shadow: none !important;
  pointer-events: auto !important;
  transition: all 0.3s ease;
  overflow: hidden !important;
}

/* ============================================================
   V6.16: Ghost Input - 保持在最上層用於觸摸事件
   ============================================================ */
.avatar-file-input {
  position: absolute !important;
  left: 50% !important;
  top: 50% !important;
  transform: translate(-50%, -50%) !important;
  width: 70px !important;
  height: 70px !important;
  opacity: 0 !important;
  cursor: pointer !important;
  /* ⚡ V6.16: 絕對層級覆蓋 - 始終在最上層 */
  z-index: 1100 !important;
  pointer-events: auto !important;
  border-radius: 50% !important;
}

/* ============================================================
   V6.18: 懸停效果 - 輕微縮放，不改變層級（移除 scale(0.9) 基礎值）
   ============================================================ */
.user-avatar:hover {
  transform: scale(1.05) !important;
}
