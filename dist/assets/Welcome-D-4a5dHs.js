import{b as x,u as v,i as j,j as e,a as N}from"./index-CN-OsEeC.js";import{R as b,d as E,r as a}from"./react-vendor-BToktFYo.js";import{n as L}from"./firebase-D0136ThQ.js";import{P as u}from"./charts-BNGpwEcn.js";import{L as T}from"./LanguageSwitcher-h5a5pQY7.js";function d({onGuestMode:i}){const s=E(),{isAuthenticated:t,isLoading:r}=x(),{t:o}=v(),[l,g]=a.useState(!1);a.useEffect(()=>{console.log("i18n current language:",j.language)},[]),a.useEffect(()=>{const h=async()=>{if(l||t)return;const n=localStorage.getItem("savedEmail"),m=localStorage.getItem("savedPassword");if(n&&m&&!l){console.log("Welcome - 嘗試自動登入:",n),g(!0);try{const c=await L(N,n,m);console.log("Welcome - 自動登入成功:",c.user.email),setTimeout(()=>{s("/user-info")},500)}catch(c){console.error("Welcome - 自動登入失敗:",c),localStorage.removeItem("savedEmail"),localStorage.removeItem("savedPassword")}}},w=setTimeout(()=>{h()},100);return()=>clearTimeout(w)},[l,t,s]),a.useEffect(()=>{t&&!r&&(console.log("Welcome - 用戶已認證，導航到 user-info"),s("/user-info"))},[t,r,s]);const p=()=>{s("/login")},f=()=>{i?i():s("/guest")};return e.jsxs("div",{className:"welcome-container",children:[e.jsx("div",{className:"welcome-header",children:e.jsx(T,{})}),e.jsxs("div",{className:"welcome-content",children:[e.jsx("h1",{className:"welcome-title",children:o("welcome.title")}),e.jsx("p",{className:"welcome-subtitle",children:o("welcome.subtitle")}),e.jsxs("div",{className:"button-group-mode",children:[e.jsxs("div",{className:"button-with-tooltip",children:[e.jsx("button",{onClick:p,className:"mode-btn login-btn",children:o("welcome.login")}),e.jsx("span",{className:"tooltip",children:o("welcomeTooltips.login")})]}),e.jsxs("div",{className:"button-with-tooltip",children:[e.jsx("button",{onClick:f,className:"mode-btn guest-btn",children:o("welcome.guestMode")}),e.jsx("span",{className:"tooltip",children:o("welcomeTooltips.guest")})]})]})]})]})}d.propTypes={onLogin:u.func,onGuestMode:u.func};const I=b.memo(d);export{I as default};
