import{b as Y,u as q,j as e}from"./index-B6ByJKnu.js";import{d as $,r as x}from"./react-vendor-Jhh8OXpo.js";import{C as H,D as J,E as O,F as Q}from"./standards-BS9q-QyX.js";import{R as F,B as M,C as w,X as D,Y as T,T as C,L as W,f as I,P as A}from"./charts-D1I5GTBR.js";import"./firebase-lL8zW3tR.js";function Z({onComplete:j}){var L,R;const{userData:n,setUserData:p}=Y(),v=$(),{weight:d,age:f,gender:u}=n,{t:s}=q(),[m,k]=x.useState(((R=(L=n.testInputs)==null?void 0:L.muscle)==null?void 0:R.smm)||""),[a,B]=x.useState({smmScore:null,smPercent:null,smPercentScore:null,finalScore:null}),[b,N]=x.useState(!1);x.useEffect(()=>{var l;if(m){const t={...n.testInputs,muscle:{...(l=n.testInputs)==null?void 0:l.muscle,smm:m}};p(c=>({...c,testInputs:t}))}},[m,p,n.testInputs]);const K=l=>{if(!l)return null;const t=parseInt(l);return t>=10&&t<=12?"10-12":t>=13&&t<=17?"13-17":t>=18&&t<=30?"18-30":t>=31&&t<=40?"31-40":t>=41&&t<=50?"41-50":t>=51&&t<=60?"51-60":t>=61&&t<=70?"61-70":t>=71&&t<=80?"71-80":null},S=(l,t)=>{if(l>=t[100])return 100;if(l<=t[0])return 0;let c=0,r=100;for(let i=10;i<=100;i+=10)if(l<t[i]){r=i,c=i-10;break}const o=t[c],h=t[r];if(h===o)return r;const g=c+(l-o)/(h-o)*(r-c);return Math.round(g*100)/100},U=()=>{if(!d||!m||!f||!u){alert(s("tests.muscleErrors.missingPrerequisites"));return}const l=parseFloat(d),t=parseFloat(m),c=K(f);if(!l||!t||!c){alert(s("tests.muscleErrors.invalidInputs"));return}const r=(t/l*100).toFixed(2),o=u==="Áî∑ÊÄß"||u.toLowerCase()==="male"?"male":"female",h=o==="male"?H:J,g=o==="male"?O:Q,i=h[c],E=g[c];if(!i||!E){alert(s("tests.muscleErrors.standardsNotFound"));return}const P=S(t,i),y=S(parseFloat(r),E),X=((P+y)/2).toFixed(2);B({smmScore:P,smPercent:r,smPercentScore:y,finalScore:X})},V=async()=>{if(!a.finalScore){alert(s("tests.muscleErrors.needCalculate"));return}const l=sessionStorage.getItem("guestMode")==="true";try{if(b)return;N(!0);const t={...n.scores,muscleMass:parseFloat(a.finalScore)},c={...n,scores:t};p({...c,ladderScore:n.ladderScore||0});const r={smm:parseFloat(m),smPercent:parseFloat(a.smPercent),finalScore:parseFloat(a.finalScore)};j&&typeof j=="function"&&j(r),v("/user-info",{state:{from:"/muscle-mass"}})}catch(t){console.error("Êèê‰∫§Â§±Êïó:",t),l||alert(s("tests.muscleErrors.updateUserFail")),v("/user-info",{state:{from:"/muscle-mass"}})}finally{N(!1)}},z=[{name:s("tests.muscleLabels.smmShort"),value:a.smmScore||0},{name:s("tests.muscleLabels.smPercentShort"),value:a.smPercentScore||0}],G=[{name:s("tests.muscleLabels.finalScore"),value:a.finalScore||0}];return e.jsxs("div",{className:"muscle-container",children:[e.jsx("h1",{children:s("tests.muscleTitle")}),e.jsxs("div",{className:"input-section",children:[e.jsxs("p",{className:"result-text",children:[s("common.weightLabel"),"Ôºö",d?`${d} kg`:s("common.notEntered")]}),e.jsxs("p",{className:"result-text",children:[s("common.ageLabel"),"Ôºö",f||s("common.notEntered")]}),e.jsxs("p",{className:"result-text",children:[s("common.genderLabel"),"Ôºö",u||s("common.notSelected")]}),e.jsx("label",{htmlFor:"smm",className:"input-label",children:s("tests.muscleLabels.smmKg")}),e.jsx("input",{id:"smm",name:"smm",type:"number",placeholder:s("tests.muscleLabels.smmKg"),value:m,onChange:l=>k(l.target.value),className:"input-field"}),e.jsx("button",{onClick:U,className:"calculate-btn",children:s("common.calculate")})]}),a.smmScore!==null&&e.jsxs("div",{className:"result-section",children:[e.jsx("h2",{className:"result-title",children:s("tests.muscleLabels.sectionTitle")}),e.jsxs("div",{className:"concise-explanation",children:[e.jsx("h3",{children:s("tests.muscleLabels.muscleExplanation.title")}),e.jsxs("div",{className:"dual-metrics",children:[e.jsxs("div",{className:"metric",children:[e.jsxs("h4",{children:["üìè ",s("tests.muscleLabels.muscleExplanation.weightTitle")]}),e.jsx("p",{children:s("tests.muscleLabels.muscleExplanation.weightDesc")})]}),e.jsxs("div",{className:"metric",children:[e.jsxs("h4",{children:["üìä ",s("tests.muscleLabels.muscleExplanation.percentTitle")]}),e.jsx("p",{children:s("tests.muscleLabels.muscleExplanation.percentDesc")})]})]}),e.jsxs("div",{className:"why-both",children:[e.jsx("h4",{children:s("tests.muscleLabels.muscleExplanation.whyBoth")}),e.jsxs("div",{className:"examples",children:[e.jsx("p",{children:e.jsx("strong",{children:s("tests.muscleLabels.muscleExplanation.example1")})}),e.jsx("p",{children:e.jsx("strong",{children:s("tests.muscleLabels.muscleExplanation.example2")})})]}),e.jsx("div",{className:"solution",children:e.jsx("p",{children:e.jsx("strong",{children:s("tests.muscleLabels.muscleExplanation.solution")})})})]})]}),e.jsxs("div",{className:"scoring-reference",children:[e.jsx("h3",{children:s("tests.muscleLabels.scoringReference.title")}),e.jsxs("div",{className:"reference-levels",children:[e.jsxs("div",{className:"level average",children:[e.jsx("div",{className:"level-icon",children:"üë§"}),e.jsxs("div",{className:"level-content",children:[e.jsx("h4",{children:s("tests.muscleLabels.scoringReference.average.title")}),e.jsx("p",{className:"score-range",children:s("tests.muscleLabels.scoringReference.average.range")}),e.jsx("p",{className:"description",children:s("tests.muscleLabels.scoringReference.average.desc")})]})]}),e.jsxs("div",{className:"level above-average",children:[e.jsx("div",{className:"level-icon",children:"üí™"}),e.jsxs("div",{className:"level-content",children:[e.jsx("h4",{children:s("tests.muscleLabels.scoringReference.aboveAverage.title")}),e.jsx("p",{className:"score-range",children:s("tests.muscleLabels.scoringReference.aboveAverage.range")}),e.jsx("p",{className:"description",children:s("tests.muscleLabels.scoringReference.aboveAverage.desc")})]})]}),e.jsxs("div",{className:"level intermediate",children:[e.jsx("div",{className:"level-icon",children:"üèÉ"}),e.jsxs("div",{className:"level-content",children:[e.jsx("h4",{children:s("tests.muscleLabels.scoringReference.intermediate.title")}),e.jsx("p",{className:"score-range",children:s("tests.muscleLabels.scoringReference.intermediate.range")}),e.jsx("p",{className:"description",children:s("tests.muscleLabels.scoringReference.intermediate.desc")})]})]}),e.jsxs("div",{className:"level excellent",children:[e.jsx("div",{className:"level-icon",children:"‚≠ê"}),e.jsxs("div",{className:"level-content",children:[e.jsx("h4",{children:s("tests.muscleLabels.scoringReference.excellent.title")}),e.jsx("p",{className:"score-range",children:s("tests.muscleLabels.scoringReference.excellent.range")}),e.jsx("p",{className:"description",children:s("tests.muscleLabels.scoringReference.excellent.desc")})]})]}),e.jsxs("div",{className:"level elite",children:[e.jsx("div",{className:"level-icon",children:"üèÜ"}),e.jsxs("div",{className:"level-content",children:[e.jsx("h4",{children:s("tests.muscleLabels.scoringReference.elite.title")}),e.jsx("p",{className:"score-range",children:s("tests.muscleLabels.scoringReference.elite.range")}),e.jsx("p",{className:"description",children:s("tests.muscleLabels.scoringReference.elite.desc")})]})]})]}),e.jsx("div",{className:"your-score",children:e.jsx("p",{children:e.jsxs("strong",{children:[s("tests.muscleLabels.scoringReference.yourScore"),":"," ",a.finalScore,"ÂàÜ"]})})})]}),e.jsxs("p",{className:"result-text",children:[s("tests.muscleLabels.smmShort"),": ",a.smmScore]}),e.jsxs("p",{className:"result-text",children:[s("tests.muscleLabels.smPercentShort"),": ",a.smPercent,"%"]}),e.jsxs("p",{className:"result-text",children:[s("tests.muscleLabels.smPercentScore"),": ",a.smPercentScore]}),e.jsxs("p",{className:"score-text final-score",children:[s("tests.muscleLabels.finalScore"),": ",a.finalScore]})]}),a.finalScore&&e.jsxs("div",{className:"chart-section",children:[e.jsx("h2",{className:"result-title",children:s("tests.muscleLabels.numbersComparison")}),e.jsx("div",{className:"chart-container",children:e.jsx(F,{width:"100%",height:300,children:e.jsxs(M,{data:z,barSize:30,children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"name",label:{value:s("tests.muscleLabels.chartName"),position:"insideBottom",offset:-5}}),e.jsx(T,{domain:[0,100],label:{value:s("tests.muscleLabels.chartScore"),angle:-90,position:"insideLeft"}}),e.jsx(C,{}),e.jsx(W,{}),e.jsx(I,{dataKey:"value",fill:"#4bc0c0",name:s("tests.muscleLabels.chartScore")})]})})}),e.jsx("h2",{className:"text-lg font-semibold mt-6 mb-4",children:s("tests.muscleLabels.finalScore")}),e.jsx("div",{className:"chart-container",children:e.jsx(F,{width:"100%",height:200,children:e.jsxs(M,{data:G,barSize:30,children:[e.jsx(w,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"name",label:{value:s("tests.muscleLabels.chartName"),position:"insideBottom",offset:-5}}),e.jsx(T,{domain:[0,100],label:{value:s("tests.muscleLabels.chartScore"),angle:-90,position:"insideLeft"}}),e.jsx(C,{}),e.jsx(I,{dataKey:"value",fill:"#36a2eb",name:s("tests.muscleLabels.chartScore")})]})})})]}),e.jsx("div",{className:"button-group",children:e.jsx("button",{type:"button",onClick:V,className:"submit-btn",disabled:b,children:s(b?"common.submitting":"common.submitAndReturn")})})]})}Z.propTypes={onComplete:A.func,clearTestData:A.func};export{Z as default};
