import{u as w,a as x,i as v,j as e,b as j}from"./index-u_ODcrAP.js";import{d as N,r as a}from"./react-vendor-BToktFYo.js";import{n as b}from"./firebase-D0136ThQ.js";import{P as u}from"./charts-BNGpwEcn.js";import{L as E}from"./LanguageSwitcher-tb8l1i19.js";function L({onGuestMode:c}){const s=N(),{isAuthenticated:t,isLoading:r}=w(),{t:o}=x(),[l,d]=a.useState(!1);a.useEffect(()=>{console.log("i18n current language:",v.language)},[]),a.useEffect(()=>{const f=async()=>{if(l||t)return;const n=localStorage.getItem("savedEmail"),m=localStorage.getItem("savedPassword");if(n&&m&&!l){console.log("Welcome - 嘗試自動登入:",n),d(!0);try{const i=await b(j,n,m);console.log("Welcome - 自動登入成功:",i.user.email),setTimeout(()=>{s("/user-info")},500)}catch(i){console.error("Welcome - 自動登入失敗:",i),localStorage.removeItem("savedEmail"),localStorage.removeItem("savedPassword")}}},h=setTimeout(()=>{f()},100);return()=>clearTimeout(h)},[l,t,s]),a.useEffect(()=>{t&&!r&&(console.log("Welcome - 用戶已認證，導航到 user-info"),s("/user-info"))},[t,r,s]);const g=()=>{s("/login")},p=()=>{c?c():s("/guest")};return e.jsxs("div",{className:"welcome-container",children:[e.jsx("div",{className:"welcome-header",children:e.jsx(E,{})}),e.jsxs("div",{className:"welcome-content",children:[e.jsx("h1",{className:"welcome-title",children:o("welcome.title")}),e.jsx("p",{className:"welcome-subtitle",children:o("welcome.subtitle")}),e.jsxs("div",{className:"button-group-mode",children:[e.jsxs("div",{className:"button-with-tooltip",children:[e.jsx("button",{onClick:g,className:"mode-btn login-btn",children:o("welcome.login")}),e.jsx("span",{className:"tooltip",children:o("welcomeTooltips.login")})]}),e.jsxs("div",{className:"button-with-tooltip",children:[e.jsx("button",{onClick:p,className:"mode-btn guest-btn",children:o("welcome.guestMode")}),e.jsx("span",{className:"tooltip",children:o("welcomeTooltips.guest")})]})]})]})]})}L.propTypes={onLogin:u.func,onGuestMode:u.func};export{L as default};
