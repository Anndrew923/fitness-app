# Netlify éƒ¨ç½²å•é¡Œè¨ºæ–·æŒ‡å—

## ğŸ“‹ å•é¡Œæ¦‚è¿°

**ç—‡ç‹€**ï¼šæœ¬åœ°æ¸¬è©¦æ­£å¸¸ï¼Œä½† Netlify ç”Ÿç”¢æ¨¡å¼ç„¡æ³•é–‹å•Ÿï¼Œå‡ºç¾ç©ºç™½é é¢ã€‚

**éŒ¯èª¤è¨Šæ¯**ï¼š
- `Failed to load module script: Expected a JavaScript-or-Wasm module script but the server responded with a MIME type of "text/html"`
- `Uncaught TypeError: Cannot read properties of undefined (reading 'PureComponent')`

---

## ğŸ” æœ¬åœ°æ¸¬è©¦ vs Netlify éƒ¨ç½²çš„å·®ç•°

### æœ¬åœ°æ¸¬è©¦ç’°å¢ƒ

**ä½¿ç”¨ `npm run preview` æˆ– `npm run serve`**ï¼š
- `vite preview` æˆ– `node server.js` ä½¿ç”¨ Express
- Express çš„ `express.static` æœƒè‡ªå‹•è™•ç†éœæ…‹æ–‡ä»¶
- `/assets/*` è·¯å¾‘æœƒç›´æ¥ç”± Express æä¾›ï¼Œä¸æœƒè¢« `app.get('*')` è¦å‰‡åŒ¹é…
- éœæ…‹æ–‡ä»¶ç›´æ¥è¿”å›ï¼Œä¸æœƒè¢«é‡å®šå‘

### Netlify éƒ¨ç½²ç’°å¢ƒ

**ä½¿ç”¨ Netlify çš„ CDN å’Œé‡å®šå‘ç³»çµ±**ï¼š
- Netlify ä½¿ç”¨è‡ªå·±çš„é‡å®šå‘è¦å‰‡è™•ç†è«‹æ±‚
- é‡å®šå‘è¦å‰‡çš„é †åºå’Œèªæ³•å¾ˆé‡è¦
- å¦‚æœé…ç½®ä¸æ­£ç¢ºï¼Œéœæ…‹æ–‡ä»¶å¯èƒ½è¢«éŒ¯èª¤é‡å®šå‘åˆ° `index.html`

---

## âœ… ç•¶å‰é…ç½®

### `netlify.toml` é…ç½®

```toml
# âœ… ä¿®å¾©ï¼šå…ˆè™•ç†éœæ…‹è³‡æºï¼Œé¿å…è¢«é‡å®šå‘ï¼ˆå¿…é ˆåœ¨ /* ä¹‹å‰ï¼‰
[[redirects]]
  from = "/assets/*"
  to = "/assets/:splat"
  status = 200

# âœ… ä¿®å¾©ï¼šè™•ç† .well-known ç›®éŒ„
[[redirects]]
  from = "/.well-known/*"
  to = "/.well-known/:splat"
  status = 200

# âœ… ä¿®å¾©ï¼šå…¶ä»–è·¯å¾‘é‡å®šå‘åˆ° index.htmlï¼ˆä½†æ’é™¤ assets å’Œ .well-knownï¼‰
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

### é—œéµé…ç½®é»

1. **é‡å®šå‘è¦å‰‡é †åº**ï¼š`/assets/*` å¿…é ˆåœ¨ `/*` ä¹‹å‰
2. **MIME é¡å‹é…ç½®**ï¼šç¢ºä¿ JavaScript æ–‡ä»¶è¿”å›æ­£ç¢ºçš„ Content-Type
3. **ç·©å­˜é…ç½®**ï¼šéœæ…‹è³‡æºä½¿ç”¨é•·æœŸç·©å­˜

---

## ğŸš¨ å¦‚æœå•é¡Œä»ç„¶å­˜åœ¨

### 1. æ¸…é™¤ Netlify æ§‹å»ºç·©å­˜

**æ­¥é©Ÿ**ï¼š
1. ç™»å…¥ Netlify æ§åˆ¶å°
2. é¸æ“‡æ‚¨çš„ç«™é»
3. å‰å¾€ **Site settings** > **Build & deploy**
4. é»æ“Š **Clear cache and deploy site**
5. ç­‰å¾…é‡æ–°éƒ¨ç½²å®Œæˆ

### 2. æª¢æŸ¥ Netlify æ§‹å»ºæ—¥èªŒ

**æ­¥é©Ÿ**ï¼š
1. åœ¨ Netlify æ§åˆ¶å°ä¸­ï¼Œå‰å¾€ **Deploys** æ¨™ç±¤
2. é»æ“Šæœ€æ–°çš„éƒ¨ç½²
3. æŸ¥çœ‹æ§‹å»ºæ—¥èªŒï¼Œç¢ºèªï¼š
   - æ§‹å»ºæˆåŠŸ
   - æ‰€æœ‰æ–‡ä»¶æ­£ç¢ºæ‰“åŒ…
   - æ²’æœ‰éŒ¯èª¤æˆ–è­¦å‘Š

### 3. é©—è­‰éƒ¨ç½²çš„æ–‡ä»¶

**æª¢æŸ¥é …ç›®**ï¼š
- `dist/index.html` æ˜¯å¦å­˜åœ¨
- `dist/assets/` ç›®éŒ„æ˜¯å¦åŒ…å«æ‰€æœ‰ JavaScript æ–‡ä»¶
- æ–‡ä»¶åæ˜¯å¦èˆ‡ `index.html` ä¸­å¼•ç”¨çš„æ–‡ä»¶åä¸€è‡´

### 4. æ¸¬è©¦é‡å®šå‘è¦å‰‡

**ä½¿ç”¨ curl æ¸¬è©¦**ï¼š
```bash
# æ¸¬è©¦éœæ…‹æ–‡ä»¶
curl -I https://your-site.netlify.app/assets/index-xxx.js

# æ‡‰è©²è¿”å›ï¼š
# Content-Type: application/javascript
# Status: 200

# æ¸¬è©¦ SPA è·¯ç”±
curl -I https://your-site.netlify.app/some-route

# æ‡‰è©²è¿”å›ï¼š
# Content-Type: text/html
# Status: 200
```

### 5. æª¢æŸ¥ç€è¦½å™¨ç¶²çµ¡è«‹æ±‚

**æ­¥é©Ÿ**ï¼š
1. æ‰“é–‹ç€è¦½å™¨é–‹ç™¼è€…å·¥å…·
2. å‰å¾€ **Network** æ¨™ç±¤
3. é‡æ–°è¼‰å…¥é é¢
4. æª¢æŸ¥ `/assets/*.js` è«‹æ±‚ï¼š
   - **Status**: æ‡‰è©²æ˜¯ 200
   - **Content-Type**: æ‡‰è©²æ˜¯ `application/javascript`
   - **Response**: æ‡‰è©²æ˜¯ JavaScript ä»£ç¢¼ï¼Œä¸æ˜¯ HTML

---

## ğŸ”§ æ›¿ä»£è§£æ±ºæ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šç§»é™¤ `/assets/*` é‡å®šå‘è¦å‰‡

æ ¹æ“š Netlify æœ€ä½³å¯¦è¸ï¼Œéœæ…‹æ–‡ä»¶ä¸éœ€è¦é‡å®šå‘è¦å‰‡ã€‚å¯ä»¥å˜—è©¦ç§»é™¤ï¼š

```toml
# ç§»é™¤é€™å€‹è¦å‰‡
# [[redirects]]
#   from = "/assets/*"
#   to = "/assets/:splat"
#   status = 200

# åªä¿ç•™ SPA è·¯ç”±é‡å®šå‘
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ `_redirects` æ–‡ä»¶

å¦‚æœ `netlify.toml` çš„é‡å®šå‘è¦å‰‡ä¸ç”Ÿæ•ˆï¼Œå¯ä»¥å˜—è©¦ä½¿ç”¨ `public/_redirects` æ–‡ä»¶ï¼š

```bash
# åœ¨ public/_redirects æ–‡ä»¶ä¸­
/assets/* /assets/:splat 200
/.well-known/* /.well-known/:splat 200
/* /index.html 200
```

**æ³¨æ„**ï¼šå¦‚æœä½¿ç”¨ `_redirects` æ–‡ä»¶ï¼Œå¿…é ˆåˆªé™¤ `netlify.toml` ä¸­çš„é‡å®šå‘è¦å‰‡ï¼Œé¿å…è¡çªã€‚

### æ–¹æ¡ˆ 3ï¼šæª¢æŸ¥ Netlify æ§‹å»ºç’°å¢ƒ

**å¯èƒ½å•é¡Œ**ï¼š
- Node.js ç‰ˆæœ¬ä¸ä¸€è‡´
- æ§‹å»ºç’°å¢ƒè®Šæ•¸ç¼ºå¤±
- ä¾è³´å®‰è£å¤±æ•—

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
1. åœ¨ `netlify.toml` ä¸­æŒ‡å®š Node.js ç‰ˆæœ¬ï¼š
```toml
[build]
  command = "npm run build"
  publish = "dist"
  environment = { NODE_VERSION = "20" }
```

2. æª¢æŸ¥ Netlify ç’°å¢ƒè®Šæ•¸è¨­ç½®

---

## ğŸ“ æª¢æŸ¥æ¸…å–®

åœ¨éƒ¨ç½²å‰ï¼Œç¢ºèªä»¥ä¸‹é …ç›®ï¼š

- [ ] `netlify.toml` é…ç½®æ­£ç¢º
- [ ] é‡å®šå‘è¦å‰‡é †åºæ­£ç¢ºï¼ˆ`/assets/*` åœ¨ `/*` ä¹‹å‰ï¼‰
- [ ] MIME é¡å‹é…ç½®æ­£ç¢º
- [ ] æ§‹å»ºæˆåŠŸï¼Œæ²’æœ‰éŒ¯èª¤
- [ ] `dist` ç›®éŒ„åŒ…å«æ‰€æœ‰å¿…è¦æ–‡ä»¶
- [ ] å·²æ¸…é™¤ Netlify æ§‹å»ºç·©å­˜
- [ ] å·²é‡æ–°éƒ¨ç½²æ‡‰ç”¨

---

## ğŸ¯ é æœŸçµæœ

ä¿®å¾©å¾Œï¼Œæ‡‰è©²çœ‹åˆ°ï¼š

1. **æ§‹å»ºæˆåŠŸ**ï¼šNetlify æ§‹å»ºæ—¥èªŒé¡¯ç¤ºæˆåŠŸ
2. **æ–‡ä»¶æ­£ç¢ºè¼‰å…¥**ï¼šç€è¦½å™¨ Network æ¨™ç±¤é¡¯ç¤ºæ‰€æœ‰ JavaScript æ–‡ä»¶è¿”å› 200
3. **æ­£ç¢ºçš„ MIME é¡å‹**ï¼šJavaScript æ–‡ä»¶è¿”å› `application/javascript`
4. **æ‡‰ç”¨æ­£å¸¸é‹è¡Œ**ï¼šé é¢æ­£å¸¸é¡¯ç¤ºï¼Œæ²’æœ‰ç©ºç™½é é¢

---

**æœ€å¾Œæ›´æ–°**: 2025-01-XX  
**ç‹€æ…‹**: å¾…é©—è­‰

