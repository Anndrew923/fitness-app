# å¤©æ¢¯å‹•ç•«å¯è¦‹æ€§æ”¹é€²èˆ‡é¡¯ç¤ºç¯„åœå„ªåŒ–

## ðŸŽ¯ å•é¡Œåˆ†æž

ç”¨æˆ¶åæ˜ çš„å…©å€‹é—œéµå•é¡Œï¼š

1. **å‹•ç•«æ•ˆæžœä¸æ˜Žé¡¯**ï¼šç”¨æˆ¶é€²å…¥æ™‚å·²ç¶“åœ¨æ–°æŽ’åä½ç½®ï¼Œçœ‹ä¸åˆ°å¾žèˆŠæŽ’åé£›æ˜‡çš„æ•ˆæžœ
2. **é¡¯ç¤ºç¯„åœä¸é©åˆ**ï¼šç¸½æ˜¯é¡¯ç¤ºå‰ 50 åï¼Œè€Œä¸æ˜¯ä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒçš„ç¯„åœ

## ðŸ”§ ä¿®å¾©æ–¹æ¡ˆ

### 1. **ä¿®å¾©å‹•ç•«è§¸ç™¼æ™‚æ©Ÿ**

#### å•é¡Œæ ¹æº

ç”¨æˆ¶é€²å…¥å¤©æ¢¯é é¢æ™‚ï¼Œ`displayUserRank` å·²ç¶“è¢«è¨­ç½®ç‚ºæ–°æŽ’åï¼Œæ‰€ä»¥çœ‹ä¸åˆ°å¾žèˆŠæŽ’åé–‹å§‹çš„å‹•ç•«ã€‚

#### ä¿®å¾©æ–¹æ¡ˆ

```javascript
// é‡è¦ï¼šè¨­ç½®é¡¯ç¤ºæŽ’åç‚ºèˆŠæŽ’åï¼Œè®“ç”¨æˆ¶çœ‹åˆ°å¾žèˆŠæŽ’åé–‹å§‹çš„å‹•ç•«
setDisplayUserRank(oldRank);
console.log(`ðŸ‘ï¸ è¨­ç½®é¡¯ç¤ºæŽ’åç‚ºèˆŠæŽ’åï¼š${oldRank}ï¼Œæº–å‚™å‹•ç•«`);

// å»¶é²è§¸ç™¼å‹•ç•«ï¼Œè®“ç”¨æˆ¶å…ˆçœ‹åˆ°èˆŠæŽ’åä½ç½®
setTimeout(() => {
  console.log(`ðŸŽ¬ é–‹å§‹å‹•ç•«ï¼šå¾žç¬¬ ${oldRank} åé£›æ˜‡åˆ°ç¬¬ ${newRank} å`);
  setPromotionAnimation({
    isActive: true,
    oldRank: oldRank,
    newRank: newRank,
    direction: 'up',
    progress: 0,
  });
}, 1500); // å¢žåŠ å»¶é²æ™‚é–“ï¼Œè®“ç”¨æˆ¶æ¸…æ¥šçœ‹åˆ°èµ·å§‹ä½ç½®
```

### 2. **å„ªåŒ–é¡¯ç¤ºç¯„åœ**

#### åŽŸä¾†çš„é‚è¼¯

```javascript
const limitCount = showUserContext && userRank > 50 ? userRank + 15 : 50;
```

#### æ–°çš„é‚è¼¯

```javascript
// è¨ˆç®—æŸ¥è©¢é™åˆ¶ï¼šä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒé¡¯ç¤º
let limitCount = 50; // é»˜èªé¡¯ç¤º50å
if (userData && userData.ladderRank > 0) {
  // å¦‚æžœç”¨æˆ¶æœ‰æŽ’åï¼Œä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒé¡¯ç¤ºå‰å¾Œå„25å
  const userRank = userData.ladderRank;
  limitCount = Math.max(50, userRank + 25);
  console.log(
    `ðŸŽ¯ ä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒé¡¯ç¤ºï¼šç”¨æˆ¶æŽ’å=${userRank}, æŸ¥è©¢é™åˆ¶=${limitCount}`
  );
}
```

## ðŸŽ¨ å‹•ç•«æ•ˆæžœå¢žå¼·

### 1. **å¢žå¼·é£›æ˜‡æ•ˆæžœ**

#### åŽŸä¾†çš„åƒæ•¸

```javascript
const floatHeight = 35; // åˆå§‹æµ®èµ·é«˜åº¦
const flyHeight = 150; // é£›è¡Œé«˜åº¦
const scale = 1 + progress * 0.2; // æ”¾å¤§æ•ˆæžœ
const glowIntensity = progress * 0.5; // ç™¼å…‰å¼·åº¦
```

#### å¢žå¼·å¾Œçš„åƒæ•¸

```javascript
const floatHeight = 50; // å¢žåŠ åˆå§‹æµ®èµ·é«˜åº¦
const flyHeight = 200; // å¢žåŠ é£›è¡Œé«˜åº¦
const scale = 1 + progress * 0.3; // å¢žåŠ æ”¾å¤§æ•ˆæžœ
const glowIntensity = progress * 0.8; // å¢žåŠ ç™¼å…‰å¼·åº¦

// æ·»åŠ è„ˆè¡æ•ˆæžœ
const pulseScale = 1 + Math.sin(progress * Math.PI * 4) * 0.05;
```

### 2. **å¢žå¼·æ“ é–‹æ•ˆæžœ**

#### åŽŸä¾†çš„æ•ˆæžœ

```javascript
const moveDistance = 80 * progress; // ç§»å‹•è·é›¢
const fadeIntensity = progress * 0.3;
```

#### å¢žå¼·å¾Œçš„æ•ˆæžœ

```javascript
const moveDistance = 100 * progress; // å¢žåŠ ç§»å‹•è·é›¢
const fadeIntensity = progress * 0.4;
const shakeIntensity = progress * 0.1; // æ·»åŠ éœ‡å‹•æ•ˆæžœ

return {
  transform: `translateY(${moveDistance}px) translateX(${
    Math.sin(progress * Math.PI * 8) * shakeIntensity
  }px)`,
  opacity: 1 - fadeIntensity * 0.6, // å¢žåŠ é€æ˜Žåº¦è®ŠåŒ–
  filter: `brightness(${0.8 + (1 - progress) * 0.2})`,
};
```

### 3. **æ–°å¢ž CSS å‹•ç•«æ•ˆæžœ**

#### è„ˆè¡å‹•ç•«

```css
@keyframes promotionPulse {
  0%,
  100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.05);
  }
}
```

#### éœ‡å‹•å‹•ç•«

```css
@keyframes promotionShake {
  0%,
  100% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-2px);
  }
  75% {
    transform: translateX(2px);
  }
}
```

#### è»Œè·¡æ•ˆæžœ

```css
.promotion-trail {
  position: absolute;
  width: 4px;
  height: 4px;
  background: radial-gradient(
    circle,
    rgba(255, 215, 0, 0.8) 0%,
    transparent 70%
  );
  border-radius: 50%;
  pointer-events: none;
  z-index: 999;
  animation: trailFade 1s ease-out forwards;
}
```

## ðŸ“Š é æœŸæ•ˆæžœ

### ä¿®å¾©å‰

```
ç”¨æˆ¶é€²å…¥å¤©æ¢¯é é¢
â†’ ç›´æŽ¥çœ‹åˆ°ç¬¬1åä½ç½®
â†’ å‹•ç•«æ•ˆæžœä¸æ˜Žé¡¯
â†’ é¡¯ç¤ºå‰50åï¼Œç”¨æˆ¶åœ¨ç¬¬15åçœ‹ä¸åˆ°è‡ªå·±
```

### ä¿®å¾©å¾Œ

```
ç”¨æˆ¶é€²å…¥å¤©æ¢¯é é¢
â†’ å…ˆçœ‹åˆ°ç¬¬3åä½ç½®ï¼ˆèˆŠæŽ’åï¼‰
â†’ 1.5ç§’å¾Œé–‹å§‹å‹•ç•«
â†’ æ¸…æ¥šçœ‹åˆ°å¾žç¬¬3åé£›æ˜‡åˆ°ç¬¬1å
â†’ é¡¯ç¤ºä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒçš„ç¯„åœï¼ˆç¬¬15åç”¨æˆ¶çœ‹åˆ°ç¬¬1-40åï¼‰
```

## ðŸŽ¯ ä½¿ç”¨å ´æ™¯å„ªåŒ–

### 1. **é«˜æŽ’åç”¨æˆ¶ï¼ˆå‰ 10 åï¼‰**

- é¡¯ç¤ºç¯„åœï¼šå‰ 50 å
- å‹•ç•«æ•ˆæžœï¼šæ˜Žé¡¯çš„é£›æ˜‡å’Œæ“ é–‹æ•ˆæžœ
- ç”¨æˆ¶é«”é©—ï¼šæ¸…æ¥šçœ‹åˆ°æŽ’åè®ŠåŒ–

### 2. **ä¸­ç­‰æŽ’åç”¨æˆ¶ï¼ˆ11-50 åï¼‰**

- é¡¯ç¤ºç¯„åœï¼šä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒï¼Œå‰å¾Œå„ 25 å
- å‹•ç•«æ•ˆæžœï¼šé©ä¸­çš„é£›æ˜‡æ•ˆæžœ
- ç”¨æˆ¶é«”é©—ï¼šçœ‹åˆ°è‡ªå·±çš„æŽ’åå’Œå‘¨åœç«¶çˆ­è€…

### 3. **ä½ŽæŽ’åç”¨æˆ¶ï¼ˆ50 åä»¥å¾Œï¼‰**

- é¡¯ç¤ºç¯„åœï¼šä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒï¼Œå‰å¾Œå„ 25 å
- å‹•ç•«æ•ˆæžœï¼šå¾žæœªä¸Šæ¦œåˆ°ä¸Šæ¦œçš„ç‰¹æ®Šæ•ˆæžœ
- ç”¨æˆ¶é«”é©—ï¼šæ¿€å‹µæ€§çš„ä¸Šæ¦œå‹•ç•«

## ðŸ” å‹•ç•«æµç¨‹

### 1. **é€²å…¥é é¢**

```
ðŸ”¥ å¾ž Firebase è®€å–èˆŠæŽ’åï¼š3
ðŸŽ¯ ä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒé¡¯ç¤ºï¼šç”¨æˆ¶æŽ’å=3, æŸ¥è©¢é™åˆ¶=28
ðŸ‘ï¸ è¨­ç½®é¡¯ç¤ºæŽ’åç‚ºèˆŠæŽ’åï¼š3ï¼Œæº–å‚™å‹•ç•«
```

### 2. **å‹•ç•«æº–å‚™**

```
ç”¨æˆ¶çœ‹åˆ°è‡ªå·±åœ¨ç¬¬3åä½ç½®
ç­‰å¾…1.5ç§’ï¼Œè®“ç”¨æˆ¶æ¸…æ¥šçœ‹åˆ°èµ·å§‹ä½ç½®
```

### 3. **å‹•ç•«åŸ·è¡Œ**

```
ðŸŽ¬ é–‹å§‹å‹•ç•«ï¼šå¾žç¬¬ 3 åé£›æ˜‡åˆ°ç¬¬ 1 å
ðŸŽ¨ å‹•ç•«é€²åº¦ï¼šç”¨æˆ¶åç¨± - 50%
ðŸŽ¨ å‹•ç•«é€²åº¦ï¼šç”¨æˆ¶åç¨± - 100%
```

### 4. **å‹•ç•«å®Œæˆ**

```
âœ… å‹•ç•«å®Œæˆï¼Œæ›´æ–°é¡¯ç¤ºæŽ’åç‚ºæ–°æŽ’åï¼š1
ðŸ§¹ å‹•ç•«å®Œæˆï¼Œæ¸…é™¤ localStorage ä¸­çš„èˆŠæŽ’åæ•¸æ“šï¼ˆä¿ç•™ Firebase ladderRankï¼‰
```

## ðŸš€ æ€§èƒ½å„ªåŒ–

### 1. **å‹•ç•«æ€§èƒ½**

- ä½¿ç”¨ `willChange` å±¬æ€§å„ªåŒ–æ¸²æŸ“
- ä½¿ç”¨ `transform` è€Œä¸æ˜¯æ”¹è®Šä½ç½®å±¬æ€§
- ä½¿ç”¨ `requestAnimationFrame` å„ªåŒ–å‹•ç•«å¹€çŽ‡

### 2. **é¡¯ç¤ºç¯„åœå„ªåŒ–**

- å‹•æ…‹è¨ˆç®—æŸ¥è©¢é™åˆ¶ï¼Œé¿å…éŽåº¦æŸ¥è©¢
- å®¢æˆ¶ç«¯éŽæ¿¾æ¸›å°‘æœå‹™å™¨è² è¼‰
- æ™ºèƒ½ç·©å­˜æ¸›å°‘é‡è¤‡è«‹æ±‚

### 3. **ç”¨æˆ¶é«”é©—å„ªåŒ–**

- å»¶é²å‹•ç•«è§¸ç™¼ï¼Œè®“ç”¨æˆ¶å…ˆçœ‹åˆ°èµ·å§‹ä½ç½®
- å¢žå¼·è¦–è¦ºæ•ˆæžœï¼Œè®“å‹•ç•«æ›´æ˜Žé¡¯
- æ·»åŠ éœ‡å‹•å’Œè„ˆè¡æ•ˆæžœï¼Œå¢žåŠ äº’å‹•æ„Ÿ

## ðŸ“ æ¸¬è©¦å»ºè­°

### 1. **å‹•ç•«å¯è¦‹æ€§æ¸¬è©¦**

1. å®Œæˆè©•æ¸¬ï¼Œè¨˜éŒ„ç•¶å‰æŽ’å
2. é€²å…¥å¤©æ¢¯é é¢
3. è§€å¯Ÿæ˜¯å¦å…ˆçœ‹åˆ°èˆŠæŽ’åä½ç½®
4. ç­‰å¾… 1.5 ç§’å¾Œè§€å¯Ÿå‹•ç•«æ•ˆæžœ

### 2. **é¡¯ç¤ºç¯„åœæ¸¬è©¦**

1. ä¸åŒæŽ’åçš„ç”¨æˆ¶é€²å…¥å¤©æ¢¯
2. æª¢æŸ¥é¡¯ç¤ºç¯„åœæ˜¯å¦ä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒ
3. é©—è­‰æŸ¥è©¢é™åˆ¶æ˜¯å¦åˆç†

### 3. **å‹•ç•«æ•ˆæžœæ¸¬è©¦**

1. è§€å¯Ÿé£›æ˜‡æ•ˆæžœæ˜¯å¦æ˜Žé¡¯
2. æª¢æŸ¥æ“ é–‹æ•ˆæžœæ˜¯å¦è‡ªç„¶
3. é©—è­‰è¦–è¦ºæ•ˆæžœæ˜¯å¦å¢žå¼·

## ðŸŽ¯ é æœŸæ”¹é€²

### 1. **å‹•ç•«å¯è¦‹æ€§**

- ç”¨æˆ¶æ¸…æ¥šçœ‹åˆ°å¾žèˆŠæŽ’åé–‹å§‹çš„å‹•ç•«
- é£›æ˜‡æ•ˆæžœæ›´åŠ æ˜Žé¡¯å’Œæˆ²åŠ‡åŒ–
- æ“ é–‹æ•ˆæžœæ›´åŠ è‡ªç„¶å’Œæµæš¢

### 2. **é¡¯ç¤ºç¯„åœ**

- ç”¨æˆ¶ç¸½èƒ½çœ‹åˆ°è‡ªå·±çš„æŽ’å
- é¡¯ç¤ºç¯„åœä»¥ç”¨æˆ¶ç‚ºä¸­å¿ƒ
- æä¾›æ›´å¥½çš„ç«¶çˆ­è¦–è§’

### 3. **ç”¨æˆ¶é«”é©—**

- æ›´å¼·çš„æˆå°±æ„Ÿ
- æ›´æ¸…æ™°çš„æŽ’åè®ŠåŒ–æ„ŸçŸ¥
- æ›´å¥½çš„è¦–è¦ºåé¥‹

## ðŸ”§ æŠ€è¡“ç´°ç¯€

### å‹•ç•«è§¸ç™¼æ™‚æ©Ÿ

```javascript
// ç¢ºä¿ç”¨æˆ¶å…ˆçœ‹åˆ°èˆŠæŽ’åä½ç½®
setDisplayUserRank(oldRank);

// å»¶é²è§¸ç™¼å‹•ç•«
setTimeout(() => {
  setPromotionAnimation({
    isActive: true,
    oldRank: oldRank,
    newRank: newRank,
    direction: 'up',
    progress: 0,
  });
}, 1500);
```

### é¡¯ç¤ºç¯„åœè¨ˆç®—

```javascript
// ä»¥ç”¨æˆ¶æŽ’åç‚ºä¸­å¿ƒçš„é¡¯ç¤ºç¯„åœ
const userRank = userData.ladderRank;
const limitCount = Math.max(50, userRank + 25);

// æŸ¥è©¢è¶³å¤ çš„æ•¸æ“šä»¥æ”¯æŒéŽæ¿¾
const queryLimit = limitCount * 2;
```

### å‹•ç•«æ•ˆæžœå¢žå¼·

```javascript
// å¢žå¼·è¦–è¦ºæ•ˆæžœ
const enhancedStyle = {
  transform: `translateY(-${floatHeight + flyDistance}px) translateX(${
    horizontalMove + initialOffset
  }px) scale(${scale * pulseScale})`,
  boxShadow: `0 ${30 * progress}px ${60 * progress}px rgba(255, 107, 53, ${
    0.8 + glowIntensity
  })`,
  filter: `brightness(${1 + progress * 0.4}) contrast(${1 + progress * 0.2})`,
  animation:
    progress > 0.5
      ? 'promotionGlow 0.5s ease-in-out infinite alternate'
      : 'none',
};
```
