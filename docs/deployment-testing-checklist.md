# 部署測試檢查清單

## 📋 概述

本文檔提供完整的部署前後測試檢查清單，確保應用程式在生產環境中正常運作。

**重要提醒**：本地測試正常 ≠ 生產環境正常！必須測試生產環境！

---

## ✅ 部署前檢查（本地測試）

### 1. 構建測試

- [ ] `npm run build` 構建成功，無錯誤
- [ ] `npm run preview` 本地預覽正常
- [ ] `npm run serve` 本地服務器正常
- [ ] 檢查 `dist` 目錄結構正確
- [ ] 檢查 `dist/index.html` 存在且正確
- [ ] 檢查 `dist/assets` 目錄存在且包含所有 chunk

### 2. 構建驗證

- [ ] 運行 `npm run build:verify` 通過
- [ ] 確認 `react-core` chunk 存在
- [ ] 確認所有必要的 chunk 都已生成
- [ ] 檢查 chunk 大小是否合理（無異常大的 chunk）

### 3. 配置檢查

- [ ] `netlify.toml` 配置正確
  - [ ] 重定向規則順序正確（`/assets/*` 在 `/*` 之前）
  - [ ] MIME 類型配置存在
  - [ ] Node 版本配置存在
- [ ] 環境變數已設置（在 Netlify 控制台）
- [ ] `.env` 文件不包含敏感信息（已加入 `.gitignore`）

---

## ✅ 部署後檢查（生產環境測試）

### 1. 基本功能測試

- [ ] 訪問生產網站，頁面正常顯示
- [ ] 無空白頁面
- [ ] 無控制台錯誤
- [ ] 登入功能正常
- [ ] 路由跳轉正常

### 2. 網絡請求檢查

打開瀏覽器開發者工具 > Network 標籤：

- [ ] `/assets/*.js` 請求返回 **200** 狀態碼
- [ ] `/assets/*.js` 的 `Content-Type` 是 `application/javascript`
- [ ] 無 404 錯誤
- [ ] 無 MIME 類型錯誤
- [ ] 所有資源正確載入

### 3. 控制台檢查

打開瀏覽器開發者工具 > Console 標籤：

- [ ] 無 `PureComponent` 錯誤
- [ ] 無模組載入錯誤
- [ ] 無 Firebase 初始化錯誤
- [ ] 無 AdMob 配置錯誤
- [ ] 警告訊息在可接受範圍內

### 4. 性能檢查

- [ ] 頁面載入時間合理（< 3 秒）
- [ ] 首次內容繪製（FCP）正常
- [ ] 最大內容繪製（LCP）正常
- [ ] 無長時間阻塞的請求

---

## 🔍 詳細檢查步驟

### 步驟 1：構建驗證

```bash
# 運行構建驗證
npm run build:verify

# 如果通過，應該看到：
# ✅ 構建驗證通過
```

### 步驟 2：本地預覽測試

```bash
# 構建
npm run build

# 預覽
npm run preview

# 在瀏覽器中訪問 http://localhost:4173
# 檢查所有功能是否正常
```

### 步驟 3：部署到 Netlify

1. 推送代碼到 Git
2. Netlify 自動檢測並開始部署
3. 等待部署完成（通常 2-5 分鐘）

### 步驟 4：生產環境測試

1. 訪問 Netlify 部署的網站
2. 打開瀏覽器開發者工具（F12）
3. 檢查 Network 標籤：
   - 確認所有 `/assets/*.js` 請求返回 200
   - 確認 `Content-Type` 正確
4. 檢查 Console 標籤：
   - 確認無錯誤訊息
5. 測試主要功能：
   - 登入/登出
   - 頁面跳轉
   - 數據載入

---

## 🚨 常見問題檢查

### 問題 1：空白頁面

**檢查項目**：
- [ ] 瀏覽器控制台是否有錯誤
- [ ] Network 標籤中是否有失敗的請求
- [ ] `index.html` 是否正確載入
- [ ] JavaScript 文件是否正確載入

**解決方案**：
- 檢查 `netlify.toml` 重定向規則
- 清除 Netlify 構建緩存
- 檢查構建日誌

### 問題 2：MIME 類型錯誤

**檢查項目**：
- [ ] `/assets/*.js` 的 `Content-Type` 是否正確
- [ ] `netlify.toml` 中是否有 MIME 類型配置

**解決方案**：
- 確認 `netlify.toml` 中有 `/assets/*.js` 的 headers 配置
- 清除 Netlify 構建緩存

### 問題 3：PureComponent 錯誤

**檢查項目**：
- [ ] `react-core` chunk 是否正確載入
- [ ] chunk 載入順序是否正確
- [ ] 是否有 React 版本兼容性問題

**解決方案**：
- 檢查 `vite.config.js` 中的 chunk 分割配置
- 確認 `react-core` 優先載入
- 檢查依賴庫是否與 React 19 兼容

---

## 📝 測試記錄模板

每次部署後，記錄以下信息：

```
部署日期：YYYY-MM-DD
部署版本：commit hash
測試人員：[您的名字]

構建狀態：✅ 成功 / ❌ 失敗
部署狀態：✅ 成功 / ❌ 失敗

測試結果：
- 基本功能：✅ / ❌
- 網絡請求：✅ / ❌
- 控制台：✅ / ❌
- 性能：✅ / ❌

發現的問題：
1. [問題描述]
2. [問題描述]

解決方案：
1. [解決方案]
2. [解決方案]
```

---

## 🎯 快速檢查命令

```bash
# 完整測試流程
npm run build:verify && npm run preview

# 部署前檢查
npm run build && npm run build:verify

# 部署後檢查（在瀏覽器中）
# 1. 訪問生產網站
# 2. 打開開發者工具
# 3. 檢查 Network 和 Console 標籤
```

---

## ⚠️ 重要提醒

1. **本地測試 ≠ 生產測試**：本地測試正常不代表生產環境正常
2. **必須測試生產環境**：每次部署後都要測試生產環境
3. **清除緩存測試**：使用無痕模式或清除緩存測試
4. **檢查構建日誌**：Netlify 構建日誌可能包含重要信息
5. **定期檢查**：建議每週檢查一次生產環境狀態

---

**最後更新**：2025-01-XX  
**維護人員**：開發團隊

