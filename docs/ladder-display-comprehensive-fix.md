# å¤©æ¢¯é¡¯ç¤ºå…¨é¢ä¿®å¾©

## ğŸš¨ å•é¡Œæè¿°

ç”¨æˆ¶å ±å‘Šå¤©æ¢¯æ’è¡Œæ¦œé¡¯ç¤ºå•é¡Œï¼š

1. **ç¬¬ä¸€åä¸è¦‹äº†**ï¼šå¤©æ¢¯æ’è¡Œæ¦œä¸­ç¬¬ä¸€åç”¨æˆ¶æ²’æœ‰é¡¯ç¤º
2. **æµ®å‹•æ’åæ¡†é¡¯ç¤ºé‚è¼¯éœ€è¦èª¿æ•´**ï¼šå¸Œæœ›æ”¹ç‚º 7 åä¹‹å¾Œæ‰é¡¯ç¤ºæµ®å‹•æ’åæ¡†

## ğŸ” å•é¡Œåˆ†æ

### 1. **ç¬¬ä¸€åæ¶ˆå¤±çš„å¯èƒ½åŸå› **ï¼š

- æŸ¥è©¢é™åˆ¶éå°ï¼Œå°è‡´ç¬¬ä¸€åè¢«éæ¿¾æ‰
- å¹´é½¡æ®µéæ¿¾å¯èƒ½éæ–¼åš´æ ¼
- æœ¬å‘¨æ–°é€²æ¦œéæ¿¾å¯èƒ½å½±éŸ¿ç¸½æ’è¡Œæ¦œ
- æ•¸æ“šè¼‰å…¥é‚è¼¯æœ‰å•é¡Œ

### 2. **æµ®å‹•æ’åæ¡†é¡¯ç¤ºé‚è¼¯**ï¼š

- ç•¶å‰è¨­å®šç‚ºå‰ 10 åå…§ä¸é¡¯ç¤ºæµ®å‹•æ¡†
- éœ€è¦èª¿æ•´ç‚ºå‰ 7 åå…§ä¸é¡¯ç¤ºæµ®å‹•æ¡†

## ğŸ”§ ä¿®å¾©æ–¹æ¡ˆ

### 1. **ä¿®å¾©ç¬¬ä¸€åæ¶ˆå¤±å•é¡Œ**

**ä¿®å¾©å‰**ï¼š

```javascript
// æŸ¥è©¢é™åˆ¶å¯èƒ½éå°
q = query(
  collection(db, 'users'),
  orderBy('ladderScore', 'desc'),
  limit(limitCount * 2) // å‹•æ…‹é™åˆ¶ï¼Œå¯èƒ½éå°
);

// æ•¸æ“šé™åˆ¶å¯èƒ½éå°
data = data.slice(0, limitCount);
```

**ä¿®å¾©å¾Œ**ï¼š

```javascript
// ç¢ºä¿èƒ½ç²å–è¶³å¤ çš„æ•¸æ“šï¼ŒåŒ…æ‹¬ç¬¬ä¸€å
q = query(
  collection(db, 'users'),
  orderBy('ladderScore', 'desc'),
  limit(100) // å›ºå®šç²å–å‰100åï¼Œç¢ºä¿ç¬¬ä¸€åä¸æœƒè¢«éæ¿¾æ‰
);

// ç¢ºä¿è‡³å°‘é¡¯ç¤ºå‰50åï¼ŒåŒ…æ‹¬ç¬¬ä¸€å
const displayCount = Math.max(50, limitCount);
data = data.slice(0, displayCount);

console.log(
  `ğŸ“Š å¤©æ¢¯æ•¸æ“šè¼‰å…¥å®Œæˆï¼šå…± ${data.length} åç”¨æˆ¶ï¼Œæœ€é«˜åˆ†ï¼š${
    data[0]?.ladderScore || 0
  }`
);
```

### 2. **èª¿æ•´æµ®å‹•æ’åæ¡†é¡¯ç¤ºé‚è¼¯**

**ä¿®å¾©å‰**ï¼š

```javascript
// å¦‚æœç”¨æˆ¶æ’ååœ¨å‰10åå…§ï¼Œä¹Ÿä¸é¡¯ç¤ºæµ®å‹•æ¡†
if (userRank > 0 && userRank <= 10) {
  return null;
}
```

**ä¿®å¾©å¾Œ**ï¼š

```javascript
// å¦‚æœç”¨æˆ¶æ’ååœ¨å‰7åå…§ï¼Œä¹Ÿä¸é¡¯ç¤ºæµ®å‹•æ¡†
if (userRank > 0 && userRank <= 7) {
  return null;
}
```

### 3. **å¢åŠ æ•¸æ“šéæ¿¾æ—¥èªŒ**

**ä¿®å¾©å‰**ï¼š

```javascript
// å®¢æˆ¶ç«¯éæ¿¾å¹´é½¡åˆ†æ®µ
if (selectedAgeGroup !== 'all') {
  data = data.filter(user => user.ageGroup === selectedAgeGroup);
}
```

**ä¿®å¾©å¾Œ**ï¼š

```javascript
// å®¢æˆ¶ç«¯éæ¿¾å¹´é½¡åˆ†æ®µ
if (selectedAgeGroup !== 'all') {
  const beforeFilterCount = data.length;
  data = data.filter(user => user.ageGroup === selectedAgeGroup);
  console.log(`ğŸ‘¥ å¹´é½¡æ®µéæ¿¾ï¼š${beforeFilterCount} â†’ ${data.length} åç”¨æˆ¶`);
}
```

## ğŸ“Š ä¿®å¾©æ•ˆæœ

### 1. **ç¬¬ä¸€åé¡¯ç¤ºä¿®å¾©**

- âœ… ç¢ºä¿ç¬¬ä¸€åç”¨æˆ¶æ­£ç¢ºé¡¯ç¤º
- âœ… æŸ¥è©¢é™åˆ¶è¶³å¤ å¤§ï¼Œä¸æœƒéæ¿¾æ‰é«˜åˆ†ç”¨æˆ¶
- âœ… æ•¸æ“šè¼‰å…¥é‚è¼¯æ›´ç©©å®š

### 2. **æµ®å‹•æ’åæ¡†é‚è¼¯å„ªåŒ–**

- âœ… å‰ 7 åç”¨æˆ¶ä¸é¡¯ç¤ºæµ®å‹•æ¡†
- âœ… ç¬¬ 8 ååŠä¹‹å¾Œçš„ç”¨æˆ¶é¡¯ç¤ºæµ®å‹•æ¡†
- âœ… é¿å…èˆ‡åˆ—è¡¨é …ç›®ç”¢ç”Ÿäº¤éŒ¯

### 3. **æ•¸æ“šéæ¿¾é€æ˜åº¦**

- âœ… å¢åŠ éæ¿¾æ—¥èªŒï¼Œä¾¿æ–¼èª¿è©¦
- âœ… æ¸…æ¥šé¡¯ç¤ºéæ¿¾å‰å¾Œçš„ç”¨æˆ¶æ•¸é‡
- âœ… ä¾¿æ–¼ç™¼ç¾æ•¸æ“šå•é¡Œ

## ğŸ¯ é¡¯ç¤ºè¦å‰‡

### 1. **å¤©æ¢¯åˆ—è¡¨é¡¯ç¤ºè¦å‰‡**ï¼š

- æŒ‰åˆ†æ•¸é™åºæ’åˆ—
- è‡³å°‘é¡¯ç¤ºå‰ 50 åç”¨æˆ¶
- æ ¹æ“šç”¨æˆ¶æ’åå‹•æ…‹èª¿æ•´é¡¯ç¤ºæ•¸é‡
- ç•¶å‰ç”¨æˆ¶æœ‰ç‰¹æ®Šé«˜äº®é¡¯ç¤º

### 2. **æµ®å‹•æ’åæ¡†é¡¯ç¤ºæ¢ä»¶**ï¼š

- ç”¨æˆ¶å¿…é ˆæœ‰æœ‰æ•ˆçš„å¤©æ¢¯åˆ†æ•¸
- ç”¨æˆ¶ä¸èƒ½å·²ç¶“åœ¨å¤©æ¢¯åˆ—è¡¨ä¸­é¡¯ç¤º
- ç”¨æˆ¶æ’åä¸èƒ½ç‚º 0ï¼ˆæœªä¸Šæ¦œï¼‰
- ç”¨æˆ¶æ’åå¿…é ˆè¶…é 7 å

### 3. **æ•¸æ“šéæ¿¾è¦å‰‡**ï¼š

- å¹´é½¡æ®µéæ¿¾ï¼šåªåœ¨é¸æ“‡ç‰¹å®šå¹´é½¡æ®µæ™‚ç”Ÿæ•ˆ
- æœ¬å‘¨æ–°é€²æ¦œï¼šåªåœ¨é¸æ“‡æœ¬å‘¨æ–°é€²æ¦œæ™‚ç”Ÿæ•ˆ
- ç¸½æ’è¡Œæ¦œï¼šé¡¯ç¤ºæ‰€æœ‰ç¬¦åˆæ¢ä»¶çš„ç”¨æˆ¶

## ğŸ” èª¿è©¦å’Œç›£æ§

### 1. **æ•¸æ“šè¼‰å…¥æ—¥èªŒ**ï¼š

```javascript
console.log(
  `ğŸ“Š å¤©æ¢¯æ•¸æ“šè¼‰å…¥å®Œæˆï¼šå…± ${data.length} åç”¨æˆ¶ï¼Œæœ€é«˜åˆ†ï¼š${
    data[0]?.ladderScore || 0
  }`
);
```

### 2. **éæ¿¾æ—¥èªŒ**ï¼š

```javascript
console.log(`ğŸ‘¥ å¹´é½¡æ®µéæ¿¾ï¼š${beforeFilterCount} â†’ ${data.length} åç”¨æˆ¶`);
console.log(`ğŸ“… æœ¬å‘¨æ–°é€²æ¦œéæ¿¾ï¼š${beforeFilterCount} â†’ ${data.length} åç”¨æˆ¶`);
```

### 3. **æ’åè¨ˆç®—æ—¥èªŒ**ï¼š

```javascript
console.log(
  `ğŸ¯ ç¢ºä¿é¡¯ç¤ºç”¨æˆ¶æ’åï¼šç”¨æˆ¶æ’å=${userRank}, æŸ¥è©¢é™åˆ¶=${limitCount}`
);
```

## ğŸš€ æ¸¬è©¦å»ºè­°

### 1. **ç¬¬ä¸€åé¡¯ç¤ºæ¸¬è©¦**ï¼š

1. æª¢æŸ¥å¤©æ¢¯æ’è¡Œæ¦œæ˜¯å¦é¡¯ç¤ºç¬¬ä¸€å
2. ç¢ºèªç¬¬ä¸€ååˆ†æ•¸å’Œç”¨æˆ¶ä¿¡æ¯æ­£ç¢º
3. é©—è­‰ç¬¬ä¸€åæ’åå¾½ç« é¡¯ç¤ºæ­£ç¢º

### 2. **æµ®å‹•æ’åæ¡†æ¸¬è©¦**ï¼š

1. æ¸¬è©¦æ’åç¬¬ 7 åçš„ç”¨æˆ¶ï¼ˆä¸æ‡‰é¡¯ç¤ºæµ®å‹•æ¡†ï¼‰
2. æ¸¬è©¦æ’åç¬¬ 8 åçš„ç”¨æˆ¶ï¼ˆæ‡‰é¡¯ç¤ºæµ®å‹•æ¡†ï¼‰
3. ç¢ºèªæµ®å‹•æ¡†ä½ç½®å’Œå…§å®¹æ­£ç¢º

### 3. **æ•¸æ“šéæ¿¾æ¸¬è©¦**ï¼š

1. æ¸¬è©¦å¹´é½¡æ®µéæ¿¾åŠŸèƒ½
2. æ¸¬è©¦æœ¬å‘¨æ–°é€²æ¦œéæ¿¾åŠŸèƒ½
3. ç¢ºèªéæ¿¾å¾Œæ•¸æ“šæ­£ç¢º

### 4. **é‚Šç•Œæƒ…æ³æ¸¬è©¦**ï¼š

1. æ¸¬è©¦æ²’æœ‰ç”¨æˆ¶æ•¸æ“šçš„æƒ…æ³
2. æ¸¬è©¦åªæœ‰å°‘æ•¸ç”¨æˆ¶çš„æƒ…æ³
3. æ¸¬è©¦ç”¨æˆ¶æ’åç‚º 0 çš„æƒ…æ³

## ğŸ“ æŠ€è¡“ç´°ç¯€

### 1. **æŸ¥è©¢å„ªåŒ–**ï¼š

```javascript
// å›ºå®šç²å–å‰100åï¼Œç¢ºä¿æ•¸æ“šå®Œæ•´æ€§
q = query(collection(db, 'users'), orderBy('ladderScore', 'desc'), limit(100));
```

### 2. **é¡¯ç¤ºæ•¸é‡è¨ˆç®—**ï¼š

```javascript
// ç¢ºä¿è‡³å°‘é¡¯ç¤ºå‰50å
const displayCount = Math.max(50, limitCount);
data = data.slice(0, displayCount);
```

### 3. **æµ®å‹•æ¡†é¡¯ç¤ºé‚è¼¯**ï¼š

```javascript
// æª¢æŸ¥ç”¨æˆ¶æ˜¯å¦å·²ç¶“åœ¨å¤©æ¢¯åˆ—è¡¨ä¸­é¡¯ç¤º
const isUserInList = ladderData.some(user => user.id === userData?.userId);

// å¦‚æœç”¨æˆ¶å·²ç¶“åœ¨åˆ—è¡¨ä¸­é¡¯ç¤ºï¼Œä¸é¡¯ç¤ºæµ®å‹•æ¡†
if (isUserInList) {
  return null;
}

// å¦‚æœç”¨æˆ¶æ’ååœ¨å‰7åå…§ï¼Œä¹Ÿä¸é¡¯ç¤ºæµ®å‹•æ¡†
if (userRank > 0 && userRank <= 7) {
  return null;
}
```

## ğŸ”§ ç¶­è­·å»ºè­°

### 1. **æŒçºŒç›£æ§**ï¼š

- å®šæœŸæª¢æŸ¥ç¬¬ä¸€åæ˜¯å¦æ­£å¸¸é¡¯ç¤º
- ç›£æ§æ•¸æ“šè¼‰å…¥æ—¥èªŒ
- è§€å¯Ÿéæ¿¾æ•ˆæœ

### 2. **æ€§èƒ½å„ªåŒ–**ï¼š

- ç›£æ§æŸ¥è©¢æ€§èƒ½
- å„ªåŒ–æ•¸æ“šéæ¿¾é‚è¼¯
- ç¢ºä¿éŸ¿æ‡‰é€Ÿåº¦

### 3. **ç”¨æˆ¶é«”é©—**ï¼š

- æ”¶é›†ç”¨æˆ¶åé¥‹
- ç›£æ§éŒ¯èª¤å ±å‘Š
- æŒçºŒæ”¹é€²é¡¯ç¤ºæ•ˆæœ

## ğŸ¯ é æœŸæ•ˆæœ

### 1. **é¡¯ç¤ºå®Œæ•´æ€§**ï¼š

- ç¬¬ä¸€åç”¨æˆ¶æ­£ç¢ºé¡¯ç¤º
- æ‰€æœ‰æ’åç”¨æˆ¶éƒ½èƒ½çœ‹åˆ°
- æµ®å‹•æ’åæ¡†ä½¿ç”¨åˆç†

### 2. **ç”¨æˆ¶é«”é©—**ï¼š

- ç•Œé¢æ›´ç›´è§€
- ä¿¡æ¯é¡¯ç¤ºæº–ç¢º
- æ“ä½œæ›´æµæš¢

### 3. **åŠŸèƒ½ç©©å®šæ€§**ï¼š

- æ•¸æ“šè¼‰å…¥æ›´ç©©å®š
- éæ¿¾åŠŸèƒ½æ­£å¸¸
- æ’åè¨ˆç®—æº–ç¢º
