# 完成全部評測項目才能參與天梯排名

## 🎯 功能概述

為了確保天梯排名的公平性和完整性，系統現在要求用戶必須完成全部 5 個評測項目才能參與天梯排名。這個改進讓天梯排名更加準確和有意義。

## 📋 評測項目清單

用戶需要完成以下 5 個評測項目：

1. **💪 力量評測** - 深蹲、臥推、硬舉等
2. **⚡ 爆發力測試** - 垂直跳躍、立定跳遠、衝刺等
3. **❤️ 心肺耐力測試** - 跑步、游泳等有氧運動
4. **🥩 骨骼肌肉量** - 身體組成分析
5. **📊 體脂肪率與 FFMI** - 體脂率和去脂體重指數

## 🔧 技術實現

### 天梯分數計算邏輯

```javascript
export const calculateLadderScore = scores => {
  const { strength, explosivePower, cardio, muscleMass, bodyFat } = scores;
  const scoreValues = [strength, explosivePower, cardio, muscleMass, bodyFat];

  // 檢查是否完成全部5個評測項目
  const completedCount = scoreValues.filter(score => score > 0).length;

  // 如果沒有完成全部5個項目，返回0（無法參與天梯排名）
  if (completedCount < 5) {
    return 0;
  }

  // 完成全部5個項目後，計算平均分數
  const total = scoreValues.reduce((sum, score) => sum + Number(score), 0);
  return Math.round((total / 5) * 10) / 10;
};
```

### 完成狀態檢查

```javascript
const completionStatus = useMemo(() => {
  const scores = userData?.scores || DEFAULT_SCORES;
  const completedCount = Object.values(scores).filter(
    score => score > 0
  ).length;
  const isFullyCompleted = completedCount === 5;

  return {
    completedCount,
    isFullyCompleted,
    progress: (completedCount / 5) * 100,
  };
}, [userData?.scores]);
```

## 🎨 用戶界面

### 首頁完成狀態顯示

在首頁雷達圖下方，新增了完成狀態顯示區域：

- **完成度進度條**：視覺化顯示完成進度
- **完成項目計數**：顯示 "X/5" 格式
- **提示訊息**：未完成時顯示鼓勵訊息
- **天梯分數**：完成全部項目後才顯示

### 天梯頁面狀態顯示

在天梯頁面的用戶統計區域：

- **排名顯示**：未完成時顯示 "完成 X/5 項"
- **分數顯示**：未完成時顯示 "未完成"
- **頁面說明**：清楚說明參與條件

## 📊 狀態對比

### 完成前（未完成全部項目）

| 頁面 | 顯示內容       | 說明             |
| ---- | -------------- | ---------------- |
| 首頁 | 完成 3/5 項    | 顯示完成進度     |
| 天梯 | 完成 3/5 項    | 無法參與排名     |
| 分數 | 平均分數：85.2 | 只計算已完成項目 |

### 完成後（完成全部項目）

| 頁面 | 顯示內容       | 說明           |
| ---- | -------------- | -------------- |
| 首頁 | 第 15 名       | 顯示實際排名   |
| 天梯 | 第 15 名       | 可以參與排名   |
| 分數 | 天梯分數：82.4 | 5 個項目平均分 |

## 🎮 用戶體驗

### 激勵機制

1. **視覺化進度**：進度條讓用戶清楚看到完成狀態
2. **明確目標**：清楚知道需要完成 5 個項目
3. **成就感**：完成全部項目後獲得參與排名的資格
4. **公平競爭**：確保所有參與者都完成了完整的評測

### 引導流程

1. **新用戶**：看到完成度為 0/5，開始第一個評測
2. **進行中**：逐步完成各個評測項目
3. **接近完成**：看到 4/5 時，激勵完成最後一個
4. **完成後**：獲得天梯排名資格，開始競爭

## 🧪 測試案例

### 測試函數

使用開發環境的「🧮 測試分數計算」按鈕可以測試各種情況：

```javascript
// 測試案例1：完成全部5個項目
const testScores1 = {
  strength: 85,
  explosivePower: 90,
  cardio: 88,
  muscleMass: 92,
  bodyFat: 87,
};
// 結果：天梯分數 = 88.4

// 測試案例2：只完成4個項目
const testScores2 = {
  strength: 85,
  explosivePower: 0, // 未完成
  cardio: 88,
  muscleMass: 92,
  bodyFat: 87,
};
// 結果：天梯分數 = 0（無法參與排名）

// 測試案例3：全部未完成
const testScores3 = {
  strength: 0,
  explosivePower: 0,
  cardio: 0,
  muscleMass: 0,
  bodyFat: 0,
};
// 結果：天梯分數 = 0（無法參與排名）
```

## 🔄 數據遷移

### 現有用戶影響

- **已完成全部項目**：不受影響，繼續參與排名
- **部分完成**：需要完成剩餘項目才能參與排名
- **未開始**：需要從頭開始完成所有項目

### 排名調整

- 系統會自動重新計算所有用戶的天梯分數
- 未完成全部項目的用戶會被移出排名
- 排名會根據新的計算邏輯重新排序

## 📈 預期效果

### 短期效果

1. **排名準確性提升**：只有完整評測的用戶參與排名
2. **用戶參與度增加**：激勵完成全部評測項目
3. **數據質量改善**：更完整的用戶數據

### 長期效果

1. **社區活躍度**：更多用戶完成完整評測
2. **競爭公平性**：所有參與者都有完整數據
3. **平台可信度**：更專業的健身評測平台

## 📝 注意事項

### 用戶通知

- 建議在部署前通知現有用戶新的參與條件
- 提供完成剩餘評測項目的指導
- 說明新規則的公平性和必要性

### 技術考慮

- 確保數據庫中的歷史記錄保持不變
- 新記錄使用新的計算邏輯
- 監控系統性能，確保計算效率

### 用戶支持

- 提供完成評測項目的詳細指導
- 解答用戶關於新規則的疑問
- 協助用戶完成剩餘的評測項目

## 🎯 未來擴展

### 可能的增強功能

1. **階段性獎勵**：完成 3 個項目獲得銅牌，4 個項目獲得銀牌等
2. **評測提醒**：定期提醒用戶完成剩餘項目
3. **完成證書**：完成全部項目後頒發電子證書
4. **社交分享**：完成全部項目後可以分享到社交媒體

### 數據分析

- 追蹤用戶完成評測項目的順序
- 分析哪些項目最容易被跳過
- 優化評測流程，提高完成率
