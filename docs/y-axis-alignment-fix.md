# Y 軸對齊修正

## 🎯 問題描述

用戶發現 Y 軸（分數軸）的對齊位置不正確：

- 85 分看起來在 80 分的下方
- 69 分看起來在 60 分的下方
- Y 軸標籤與實際數據點位置不匹配

## 🔍 問題分析

### **問題根源**

Y 軸標籤的 Y 座標計算方式與數據點的 Y 座標計算方式不一致：

**數據點的 Y 座標計算**：

```javascript
const y = 720 - (value * 480) / 100;
```

**原 Y 軸標籤的 Y 座標計算**：

```javascript
y={765 - i * 120}
```

### **計算邏輯差異**

- **數據點**：使用實際分數值進行精確計算
- **Y 軸標籤**：使用固定的間隔計算，沒有考慮實際分數值

## 🔧 修正方案

### **修正前**：

```javascript
{
  /* Y軸標籤 */
}
{
  [...Array(5)].map((_, i) => (
    <text
      key={`y-label-${i}`}
      x="30"
      y={765 - i * 120}
      textAnchor="end"
      fontSize={axisFontSize}
      fontWeight={axisFontWeight}
      fill="#495057"
    >
      {i * 20}
    </text>
  ));
}
```

### **修正後**：

```javascript
{
  /* Y軸標籤 */
}
{
  [...Array(5)].map((_, i) => {
    const value = i * 20;
    const y = 720 - (value * 480) / 100; // 使用與數據點相同的計算方式
    return (
      <text
        key={`y-label-${i}`}
        x="30"
        y={y + 6} // 加上6px的偏移，讓文字垂直居中對齊
        textAnchor="end"
        fontSize={axisFontSize}
        fontWeight={axisFontWeight}
        fill="#495057"
      >
        {value}
      </text>
    );
  });
}
```

## 📊 修正細節

### 1. **統一計算方式**

```javascript
const y = 720 - (value * 480) / 100;
```

- 使用與數據點完全相同的 Y 座標計算公式
- 確保 Y 軸標籤與數據點在同一水平線上

### 2. **文字對齊優化**

```javascript
y={y + 6} // 加上6px的偏移
```

- 添加 6px 的垂直偏移
- 讓文字垂直居中對齊到網格線
- 提升視覺效果

### 3. **變量提取**

```javascript
const value = i * 20;
```

- 提取分數值到變量
- 避免重複計算
- 提高代碼可讀性

## 🎨 視覺效果

### **修正前**：

- Y 軸標籤位置不準確
- 85 分顯示在 80 分下方
- 69 分顯示在 60 分下方
- 視覺對齊混亂

### **修正後**：

- Y 軸標籤與數據點完美對齊
- 85 分正確對齊到 85 分位置
- 69 分正確對齊到 69 分位置
- 視覺對齊準確

## 📐 座標系統說明

### **SVG 座標系統**：

- 原點(0,0)在左上角
- Y 軸向下為正
- 圖表區域：800x800

### **數據映射**：

- 分數範圍：0-100
- Y 座標範圍：240-720
- 計算公式：`y = 720 - (value * 480) / 100`

### **網格線位置**：

- 0 分：y = 720
- 20 分：y = 624
- 40 分：y = 528
- 60 分：y = 432
- 80 分：y = 336
- 100 分：y = 240

## 🔧 技術實現

### **關鍵修正點**：

1. **統一計算公式**：

   ```javascript
   const y = 720 - (value * 480) / 100;
   ```

2. **文字對齊調整**：

   ```javascript
   y={y + 6}
   ```

3. **變量優化**：
   ```javascript
   const value = i * 20;
   ```

## 📱 響應式考慮

### **修正適用範圍**：

- 桌面版和手機版都適用
- 所有數據類型都適用
- 保持一致的對齊效果

## 📝 總結

這次修正成功解決了 Y 軸對齊問題：

### **修正內容**：

1. **統一計算方式**：Y 軸標籤使用與數據點相同的 Y 座標計算
2. **文字對齊優化**：添加 6px 偏移，讓文字垂直居中
3. **代碼優化**：提取變量，提高可讀性

### **修正效果**：

- Y 軸標籤與數據點完美對齊
- 85 分、69 分等分數正確顯示在對應位置
- 視覺效果更準確、更專業
- 用戶體驗進一步提升

### **技術要點**：

- 保持座標計算的一致性
- 考慮文字渲染的對齊需求
- 確保所有數據類型都正確對齊

現在 Y 軸的對齊問題已經完全解決，圖表的視覺效果更加準確和專業！
